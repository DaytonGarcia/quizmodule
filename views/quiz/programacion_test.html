{{extend 'template.html'}}
<script type="text/javascript" src="{{=URL('static','js/quiz-js/super.js')}}"></script>
<script type="text/javascript">
$(document).ready(
      
      function(){

        function isValidDate (value) {
            var valid = false,
                info,
                real;
            
            // Validar formato
            if (/^(0?[1-9]|[12][0-9]|3[01])[\/](0?[1-9]|1[012])[\/]\d{4}$/.test(value)) {
              
              // Validar fecha
              info = value.split(/\//);
              real = (new Date(info[2], info[1] - 1, info[0])).toISOString().substr(0,10).split('-');
              if (info[0] === real[2] && info[1] === real[1] && info[2] === real[0]) {
                valid = true;
              }
            }
            return valid;
          }
	
	$('#cboCategoria').change(function(){

        
        
        if($('#cboCategoria').val() !=0)
        {
            var idCategoria = $('#cboCategoria').val();
            var idCurso = $('#pProject').text();
            var idPeriodo = $('#pPeriod').text();

            var parametros = "?project="+idCurso+"&period="+idPeriodo+"&categorie="+idCategoria;
		    //window.location.href = "https://"+document.domain+"/quiz/test"+parametros;
            var result = submitLoad("quiz","getActivities",parametros);
            var data = JSON.parse(result);
            $('#cboActividad option').remove();
            $('#cboActividad').append($('<option>', { 
                    value: 0,
                    text : 'Seleccione una actividad' 
                }));

            for (var i in data) {

                $('#cboActividad').append($('<option>', { 
                    value: data[i]['id'],
                    text : data[i]['name'] 
                }));
                
                
             }
        }
		
    });


    $('#btGrabar').click(function()
    {
        alert( $("#dateInit").val());
        alert( isValidDate($("#dateInit").val()) );

        if($('#cboCategoria option:selected').val()==0)
        {
            alert('Por favor seleccione una categoria');
        }

        else if($('#cboActividad option:selected').val()==0)
        {
            alert('Por favor seleccione una actividad');
        }
        

    }

    );
});


</script>
</head>
<div class="row-fluid">
	<center>
	    <h2>Programacion de Evaluacion: {{ =metadata.tb_metadata_quiz.nombre }}
	    	{{if (auth.has_membership('Super-Administrator') == False )and (auth.has_membership('Ecys-Administrator') == False) :}}
	    	<a onclick="javascript:introJs().setOptions({ 'skipLabel': '{{=T('Skip')}}', 'nextLabel': '{{=T('Next')}}', 'prevLabel': '{{=T('Previous')}}', 'doneLabel': '{{=T('Exit')}}' }).start();" href='javascript:void(0);' class="btn btn-primary" >
			  <span class="icon-white icon-question-sign"></span>
			</a>
			{{pass}}
			<br>
        </h2>
	</center>
</div>
<br>
<div class="navbar" data-step=1 data-intro="Div para informacion del quiz">
    <div class="navbar-inner">
        <a style="cursor:pointer;"><center><h4>Informacion general de la evaluacion</h4></center></a>
    </div>
</div>
<div class="well" id="div_metainfo_quiz">
<p><strong>Creador:</strong> {{=metadata.auth_user.first_name}} {{=metadata.auth_user.last_name}}</p> 
<p><strong>Curso: </strong>  {{=metadata.project.name}}</p>
<p><strong>Fecha de creacion: </strong>  {{=metadata.tb_metadata_quiz.fecha_creacion}}</p></p>
</div>

<div class="navbar" data-step=1 data-intro="Div para programacion">
        <div class="navbar-inner">
            <a style="cursor:pointer;"><center><h4>Creacion de programacion para la actividad tipo evaluacion</h4></center></a>
        </div>
</div>
<div class="well" id="div_metainfo_quiz">
    <table width="100%">
        <tr>
            <td width="20%">
                    <p><strong>Categoria de actividades:</strong></p>
            </td>
            <td width="30%">
                    <select id="cboCategoria">
                            <option value="0">Seleccion una categoria</option>
                            {{for categoria in categorias:}}
                            <option value="{{=categoria.id}}">{{=categoria.category}}</option>
                            {{pass}}
                    </select>
            </td>
            <td width="20%">
                    <p><strong>Seleccione una actividad:</strong></p>

            </td>
            <td width="30%">
                    <select id="cboActividad">
                            <option value="0">Seleccione una actividad</option>
                    </select>
            </td>

        </tr>
        <tr>
            <td width="20%">
                    <p><strong>Fecha de ejecucion:</strong></p>
            </td>
            <td width="30%">
                    <input class="date" id="dateInit" name="log-date" placeholder="YYYY-MM-DD" type="text" value="" style="width:64%;" autocomplete="off">
            </td>
            <td width="20%">
                    <p><strong>Horario de ejecucion:</strong></p>
            </td>
            <td width="20%">
                    <input id="inpHora" name="hora" placeholder="HH:MM" type="time" value="" style="width:64%;" autocomplete="off">
            </td>
        </tr>
        <tr>
            <td width="20%">
                <p><strong>Duracion en minutos:</strong></p>
            </td>
            <td width="30%"> 
                <input id="txtDuracion" placeholder="mins" type="text" style="width:64%;">
            </td>
            <td width="20%">
            </td>
            <td width="30%">
                    <button id="btGrabar" type="button" class="btn btn-success">Grabar Programacion</button>
            </td>
        </tr>
    </table>

</div>
<p id="pPeriod" hidden value="{{=periodo.id}}">{{=periodo.id}}</p>
<p id="pProject" hidden value="{{=project.id}}">{{=project.id}}</p>